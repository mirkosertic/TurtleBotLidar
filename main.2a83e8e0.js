parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"d6sW":[function(require,module,exports) {
function t(t,e,a,r,l){var i=a-t,o=r-e;return Math.sqrt(i*i+o*o)+l}function e(t,e,a,r,l,i,o,n){var s,h,y,c,u,f;if(f=((y=o-l)*(e-i)-(c=n-i)*(t-l))/(-y*(h=r-e)+(s=a-t)*c),(u=(-h*(t-l)+s*(e-i))/(-y*h+s*c))>=0&&u<=1&&f>=0&&f<=1)return{x:t+f*s,y:e+f*h}}function a(t,e,a,r,l,i,o){var n,s,h,y,c,u,f,d,x,P;return P={},(x={}).x=i-r,x.y=o-l,P.x=r-t,P.y=l-e,n=x.x*P.x+x.y*P.y,s=2*(x.x*x.x+x.y*x.y),n*=-2,h=Math.sqrt(n*n-2*s*(P.x*P.x+P.y*P.y-a*a)),isNaN(h)?[]:(c=(n+h)/s,f={},d={},u=[],(y=(n-h)/s)<=1&&y>=0&&(f.x=r+x.x*y,f.y=o+x.y*y,u[0]=f),c<=1&&c>=0&&(d.x=r+x.x*c,d.y=o+x.y*c,u[u.length]=d),u)}var r=document.getElementById("rendering"),l=r.getContext("2d"),i=[{x1:0,y1:0,x2:150,y2:0},{x1:150,y1:0,x2:150,y2:100},{x1:150,y1:100,x2:0,y2:100},{x1:0,y1:0,x2:0,y2:100},{x1:150,y1:80,x2:130,y2:80},{x1:130,y1:100,x2:130,y2:80}];l.lineWidth=1,l.strokeStyle="black",l.fillStyle="black",l.scale(2,2),l.translate(100,100);var o={x:56,y:56,theta:0,lidarLength:100,lidarNoise:0,lidarMinResolution:1},n={estimatedTurtlePosition:{x:0,y:0,theta:0},features:[],featureDetectionRadius:3,moveTurtleBy:function(t,e){this.estimatedTurtlePosition.x+=t,this.estimatedTurtlePosition.y+=e},rotateTurtle:function(t){this.estimatedTurtlePosition.theta+=t}},s={smoothing:2.5,enabled:!1,currentValue:[],process:function(t,e){return this.enabled?this.currentValue[t]?(this.currentValue[t]+=(e-this.currentValue[t])/this.smoothing,this.currentValue[t]):(this.currentValue[t]=e,e):e}};function h(t){for(var e=0,a=0;0===e;)e=Math.random();for(;0===a;)a=Math.random();var r=Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*a);return(r=r/10+.5)>1||r<0?h():(r-.5)*t}function y(t,e,a){return t<0?t+=a:t>=a&&(t-=a),e[t]}var c=function(t,e,a){for(var r=[],l=0;l<e;l++){var i=y(l,t,e),o=y(l+a,t,e);i&&o&&(r[l]=o-i)}return r},u=function(t,e,a,r,i){var o=t+Math.cos(Math.PI/180*a)*r,n=e+Math.sin(Math.PI/180*a)*r;l.strokeStyle=i,l.fillStyle=i,l.beginPath(),l.moveTo(t,e),l.lineTo(o,n),l.stroke(),l.closePath()},f=function(t,e,a,r,i,o,n,s,h){for(var y=0;y<i;y++){var c=r[y];if(c){var u=t+(y+o)%i,f=e,d=f+c*n;l.beginPath(),l.strokeStyle=a,l.fillStyle=a,l.moveTo(u,f),l.lineTo(u,d),l.stroke(),l.closePath()}}l.save(),l.beginPath(),l.strokeStyle="black",l.fillStyle="black",l.moveTo(t,e-h),l.lineTo(t,e+h),l.translate(t,e),l.rotate(-Math.PI/2),l.textAlign="center",l.font="8px Arial",l.fillText(s,0,-5),l.stroke(),l.closePath(),l.restore()},d=function(){for(l.clearRect(-100,-100,1e3,1e3),l.strokeStyle="black",l.fillStyle="black",l.textAlign="left",l.font="8px Arial",l.fillText("Reality",-20,-20),l.strokeStyle="black",l.fillStyle="black",l.beginPath(),d=0;d<i.length;d++){var r=i[d];l.moveTo(r.x1,r.y1),l.lineTo(r.x2,r.y2)}l.stroke(),l.closePath(),l.beginPath(),l.strokeStyle="gray",l.fillStyle="gray",l.arc(o.x,o.y,8,0,2*Math.PI),l.stroke(),l.closePath(),u(o.x,o.y,o.theta,20,"green"),l.strokeStyle="black",l.fillStyle="black",l.textAlign="left",l.font="8px Arial",l.fillText("Turtles model no.F. = "+n.features.length,-20,120),l.beginPath(),l.strokeStyle="gray",l.fillStyle="gray",l.arc(n.estimatedTurtlePosition.x+56,n.estimatedTurtlePosition.y+200,8,0,2*Math.PI),l.stroke(),l.closePath(),u(n.estimatedTurtlePosition.x+56,n.estimatedTurtlePosition.y+200,n.estimatedTurtlePosition.theta,20,"green");for(var d=0;d<n.features.length;d++){var x=n.features[d];l.beginPath(),l.strokeStyle="black",l.fillStyle="black",l.arc(x.x-1+56,x.y-1+200,3,0,2*Math.PI),l.stroke(),l.closePath()}var P=0,k=[],g=[],v=(q=360/o.lidarMinResolution)/2;for(d=o.theta;d<o.theta+360;d+=o.lidarMinResolution,P++){for(var M=o.x+Math.cos(Math.PI/180*d)*o.lidarLength,T=o.y+Math.sin(Math.PI/180*d)*o.lidarLength,S=void 0,m=0;m<i.length;m++){r=i[m];var b=e(o.x,o.y,M,T,r.x1,r.y1,r.x2,r.y2);if(b){var I=s.process(P,t(o.x,o.y,b.x,b.y,h(o.lidarNoise)));S?S.distance>I&&(S={distance:I,intersection:b}):S={distance:I,intersection:b}}}if(S){k[P]=S.distance,g[P]=d;var A=Math.PI/180*d,w=o.x+Math.cos(A)*S.distance,R=o.y+Math.sin(A)*S.distance;l.beginPath(),l.strokeStyle="CadetBlue",l.fillStyle="CadetBlue",l.arc(w,R,2,0,2*Math.PI),l.stroke(),l.closePath(),l.beginPath(),0===P?(l.strokeStyle="green",l.fillStyle="green"):(l.strokeStyle="CadetBlue",l.fillStyle="CadetBlue");var p=200+(P+v)%q,B=(H=50)-S.distance;l.moveTo(p,H),l.lineTo(p,B),l.stroke(),l.closePath()}else l.strokeStyle="rgba(128,128,128,0.05)",l.fillStyle="rgba(128,128,128,0.05)",l.beginPath(),l.moveTo(o.x,o.y),l.lineTo(M,T),l.stroke(),l.closePath()}l.save(),l.beginPath(),l.strokeStyle="black",l.fillStyle="black",l.moveTo(200,50),l.lineTo(200,-70),l.translate(200,50),l.rotate(-Math.PI/2),l.textAlign="center",l.font="8px Arial",l.fillText("Lidar distance",60,-5),l.stroke(),l.closePath(),l.restore();var L=c(k,P,1),V=c(L,P,1),q=360/o.lidarMinResolution;f(200,90,"DarkSlateGrey",L,q,v=q/2,3,"1st derivative",20),f(200,160,"DarkSlateGrey",V,q,v,15,"2nd derivative",20);for(d=0;d<P;d++){var C=y(d,L,q),D=y(d-1,L,q),N=y(d,V,q),F=!1;C&&D&&N&&(D>=0&&C<0?F=!0:D<0&&C>.025&&(F=!0));I=k[d];if(F&&I){var E=g[d],G=(A=Math.PI/180*E,o.x+Math.cos(A)*I),U=o.y+Math.sin(A)*I;l.beginPath(),l.strokeStyle="red",l.fillStyle="red",l.arc(G,U,2,0,2*Math.PI),l.stroke(),l.closePath();var W=n.estimatedTurtlePosition.x+Math.cos(A)*o.lidarLength,j=n.estimatedTurtlePosition.y+Math.sin(A)*o.lidarLength,z=!1;for(m=0;m<n.features.length;m++){a((x=n.features[m]).x,x.y,n.featureDetectionRadius,n.estimatedTurtlePosition.x,n.estimatedTurtlePosition.y,W,j).length>0&&(z=!0)}z||n.features.push({x:n.estimatedTurtlePosition.x+Math.cos(A)*I,y:n.estimatedTurtlePosition.y+Math.sin(A)*I}),l.strokeStyle="lightgray",l.fillStyle="lightgray",l.beginPath(),l.moveTo(o.x,o.y),l.lineTo(G,U),l.stroke(),l.closePath();p=200+(d+(v=(q=360/o.lidarMinResolution)/2))%q,B=(H=90)-L[d];l.beginPath(),l.strokeStyle="red",l.fillStyle="red",l.arc(p,B,2,0,2*Math.PI),l.stroke(),l.closePath();var H;p=200+(d+v)%q,B=(H=50)-k[d];l.beginPath(),l.strokeStyle="red",l.fillStyle="red",l.arc(p,B,2,0,2*Math.PI),l.stroke(),l.closePath()}}},x=function t(){d(),window.requestAnimationFrame(t)};window.requestAnimationFrame(x),window.addEventListener("keydown",function(t){if("ArrowUp"==t.key){var e=3*Math.cos(Math.PI/180*o.theta),a=3*Math.sin(Math.PI/180*o.theta);o.x+=e,o.y+=a,n.moveTurtleBy(e,a)}if("ArrowDown"==t.key){e=-3*Math.cos(Math.PI/180*o.theta),a=-3*Math.sin(Math.PI/180*o.theta);o.x+=e,o.y+=a,n.moveTurtleBy(e,a)}"ArrowLeft"==t.key&&(o.theta-=2,n.rotateTurtle(-2)),"ArrowRight"==t.key&&(o.theta+=2,n.rotateTurtle(2))});
},{}]},{},["d6sW"], null)
//# sourceMappingURL=main.2a83e8e0.js.map