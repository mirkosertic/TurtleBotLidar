parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"d6sW":[function(require,module,exports) {
function t(t,e,a,r,l){var i=a-t,o=r-e;return Math.sqrt(i*i+o*o)+l}function e(t,e,a,r,l,i,o,n){var s,h,y,c,u,d;if(d=((y=o-l)*(e-i)-(c=n-i)*(t-l))/(-y*(h=r-e)+(s=a-t)*c),(u=(-h*(t-l)+s*(e-i))/(-y*h+s*c))>=0&&u<=1&&d>=0&&d<=1)return{x:t+d*s,y:e+d*h}}var a=document.getElementById("rendering"),r=a.getContext("2d"),l=[{x1:0,y1:0,x2:150,y2:0},{x1:150,y1:0,x2:150,y2:100},{x1:150,y1:100,x2:0,y2:100},{x1:0,y1:0,x2:0,y2:100},{x1:150,y1:80,x2:130,y2:80},{x1:130,y1:100,x2:130,y2:80}];r.lineWidth=1,r.strokeStyle="black",r.fillStyle="black",r.scale(2,2),r.translate(100,100);var i={x:56,y:56,theta:0,lidarLength:100,lidarNoise:0,lidarMinResolution:1},o={estimatedTurtlePosition:{x:0,y:0,theta:0},features:[],moveTurtleBy:function(t,e){this.estimatedTurtlePosition.x+=t,this.estimatedTurtlePosition.y+=e},rotateTurtle:function(t){this.estimatedTurtlePosition.theta+=t}},n={smoothing:2.5,enabled:!1,currentValue:[],process:function(t,e){return this.enabled?this.currentValue[t]?(this.currentValue[t]+=(e-this.currentValue[t])/this.smoothing,this.currentValue[t]):(this.currentValue[t]=e,e):e}};function s(t){for(var e=0,a=0;0===e;)e=Math.random();for(;0===a;)a=Math.random();var r=Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*a);return(r=r/10+.5)>1||r<0?s():(r-.5)*t}function h(t,e,a){return t<0?t+=a:t>=a&&(t-=a),e[t]}var y=function(t,e,a){for(var r=[],l=0;l<e;l++){var i=h(l,t,e),o=h(l+a,t,e);i&&o&&(r[l]=o-i)}return r},c=function(t,e,a,l,i){var o=t+Math.cos(Math.PI/180*a)*l,n=e+Math.sin(Math.PI/180*a)*l;r.strokeStyle=i,r.fillStyle=i,r.beginPath(),r.moveTo(t,e),r.lineTo(o,n),r.stroke(),r.closePath()},u=function(t,e,a,l,i,o,n,s,h){for(var y=0;y<i;y++){var c=l[y];if(c){var u=t+(y+o)%i,d=e,f=d+c*n;r.beginPath(),r.strokeStyle=a,r.fillStyle=a,r.moveTo(u,d),r.lineTo(u,f),r.stroke(),r.closePath()}}r.save(),r.beginPath(),r.strokeStyle="black",r.fillStyle="black",r.moveTo(t,e-h),r.lineTo(t,e+h),r.translate(t,e),r.rotate(-Math.PI/2),r.textAlign="center",r.font="8px Arial",r.fillText(s,0,-5),r.stroke(),r.closePath(),r.restore()},d=function(){for(r.clearRect(-100,-100,1e3,1e3),r.strokeStyle="black",r.fillStyle="black",r.textAlign="left",r.font="8px Arial",r.fillText("Reality",-20,-20),r.strokeStyle="black",r.fillStyle="black",r.beginPath(),x=0;x<l.length;x++){var a=l[x];r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2)}r.stroke(),r.closePath(),r.beginPath(),r.strokeStyle="gray",r.fillStyle="gray",r.arc(i.x,i.y,8,0,2*Math.PI),r.stroke(),r.closePath(),c(i.x,i.y,i.theta,20,"green"),r.strokeStyle="black",r.fillStyle="black",r.textAlign="left",r.font="8px Arial",r.fillText("Turtles model",-20,120),r.beginPath(),r.strokeStyle="gray",r.fillStyle="gray",r.arc(o.estimatedTurtlePosition.x+56,o.estimatedTurtlePosition.y+200,8,0,2*Math.PI),r.stroke(),r.closePath(),c(o.estimatedTurtlePosition.x+56,o.estimatedTurtlePosition.y+200,o.estimatedTurtlePosition.theta,20,"green");for(var d=0,f=[],P=[],k=(L=360/i.lidarMinResolution)/2,x=i.theta;x<i.theta+360;x+=i.lidarMinResolution,d++){for(var g=i.x+Math.cos(Math.PI/180*x)*i.lidarLength,v=i.y+Math.sin(Math.PI/180*x)*i.lidarLength,M=void 0,S=0;S<l.length;S++){a=l[S];var T=e(i.x,i.y,g,v,a.x1,a.y1,a.x2,a.y2);if(T){var m=n.process(d,t(i.x,i.y,T.x,T.y,s(i.lidarNoise)));M?M.distance>m&&(M={distance:m,intersection:T}):M={distance:m,intersection:T}}}if(M){f[d]=M.distance,P[d]=x;var b=Math.PI/180*x,I=i.x+Math.cos(b)*M.distance,A=i.y+Math.sin(b)*M.distance;r.beginPath(),r.strokeStyle="CadetBlue",r.fillStyle="CadetBlue",r.arc(I,A,2,0,2*Math.PI),r.stroke(),r.closePath(),r.beginPath(),0===d?(r.strokeStyle="green",r.fillStyle="green"):(r.strokeStyle="CadetBlue",r.fillStyle="CadetBlue");var w=200+(d+k)%L,B=(N=50)-M.distance;r.moveTo(w,N),r.lineTo(w,B),r.stroke(),r.closePath()}else r.strokeStyle="rgba(128,128,128,0.05)",r.fillStyle="rgba(128,128,128,0.05)",r.beginPath(),r.moveTo(i.x,i.y),r.lineTo(g,v),r.stroke(),r.closePath()}r.save(),r.beginPath(),r.strokeStyle="black",r.fillStyle="black",r.moveTo(200,50),r.lineTo(200,-70),r.translate(200,50),r.rotate(-Math.PI/2),r.textAlign="center",r.font="8px Arial",r.fillText("Lidar distance",60,-5),r.stroke(),r.closePath(),r.restore();var R=y(f,d,1),p=y(R,d,1),L=360/i.lidarMinResolution;u(200,90,"DarkSlateGrey",R,L,k=L/2,3,"1st derivative",20),u(200,160,"DarkSlateGrey",p,L,k,15,"2nd derivative",20);for(x=0;x<d;x++){var V=h(x,R,L),C=h(x-1,R,L),q=h(x,p,L),D=!1;V&&C&&q&&(C>=0&&V<0?D=!0:C<0&&V>.025&&(D=!0));m=f[x];if(D&&m){var E=P[x],F=(b=Math.PI/180*E,i.x+Math.cos(b)*m),G=i.y+Math.sin(b)*m;r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(F,G,2,0,2*Math.PI),r.stroke(),r.closePath(),r.strokeStyle="lightgray",r.fillStyle="lightgray",r.beginPath(),r.moveTo(i.x,i.y),r.lineTo(F,G),r.stroke(),r.closePath();w=200+(x+(k=(L=360/i.lidarMinResolution)/2))%L,B=(N=90)-R[x];r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(w,B,2,0,2*Math.PI),r.stroke(),r.closePath();var N;w=200+(x+k)%L,B=(N=50)-f[x];r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(w,B,2,0,2*Math.PI),r.stroke(),r.closePath()}}},f=function t(){d(),window.requestAnimationFrame(t)};window.requestAnimationFrame(f),window.addEventListener("keydown",function(t){if("ArrowUp"==t.key){var e=3*Math.cos(Math.PI/180*i.theta),a=3*Math.sin(Math.PI/180*i.theta);i.x+=e,i.y+=a,o.moveTurtleBy(e,a)}if("ArrowDown"==t.key){e=-3*Math.cos(Math.PI/180*i.theta),a=-3*Math.sin(Math.PI/180*i.theta);i.x+=e,i.y+=a,o.moveTurtleBy(e,a)}"ArrowLeft"==t.key&&(i.theta-=2,o.rotateTurtle(-2)),"ArrowRight"==t.key&&(i.theta+=2,o.rotateTurtle(2))});
},{}]},{},["d6sW"], null)
//# sourceMappingURL=main.c596d24f.js.map