parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"d6sW":[function(require,module,exports) {
function t(t,e,a,r,l){var o=a-t,i=r-e;return Math.sqrt(o*o+i*i)+l}function e(t,e,a,r,l,o,i,n){var s,h,y,c,d,P;if(P=((y=i-l)*(e-o)-(c=n-o)*(t-l))/(-y*(h=r-e)+(s=a-t)*c),(d=(-h*(t-l)+s*(e-o))/(-y*h+s*c))>=0&&d<=1&&P>=0&&P<=1)return{x:t+P*s,y:e+P*h}}var a=document.getElementById("rendering"),r=a.getContext("2d"),l=[{x1:0,y1:0,x2:150,y2:0},{x1:150,y1:0,x2:150,y2:100},{x1:150,y1:100,x2:0,y2:100},{x1:0,y1:0,x2:0,y2:100},{x1:150,y1:80,x2:130,y2:80},{x1:130,y1:100,x2:130,y2:80}];r.lineWidth=1,r.strokeStyle="black",r.fillStyle="black",r.scale(2,2),r.translate(100,100);var o={x:56,y:56,theta:0,lidarLength:100,lidarNoise:0,lidarMinResolution:1},i={smoothing:2.5,enabled:!1,currentValue:[],process:function(t,e){return this.enabled?this.currentValue[t]?(this.currentValue[t]+=(e-this.currentValue[t])/this.smoothing,this.currentValue[t]):(this.currentValue[t]=e,e):e}};function n(t){for(var e=0,a=0;0===e;)e=Math.random();for(;0===a;)a=Math.random();var r=Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*a);return(r=r/10+.5)>1||r<0?n():(r-.5)*t}function s(t,e,a){return t<0?t+=a:t>=a&&(t-=a),e[t]}var h=function(t,e,a){for(var r=[],l=0;l<e;l++){var o=s(l,t,e),i=s(l+a,t,e);o&&i&&(r[l]=i-o)}return r},y=function(t,e,a,l,o,i,n,s,h){for(var y=0;y<o;y++){var c=l[y];if(c){var d=t+(y+i)%o,P=e,f=P+c*n;r.beginPath(),r.strokeStyle=a,r.fillStyle=a,r.moveTo(d,P),r.lineTo(d,f),r.stroke(),r.closePath()}}r.save(),r.beginPath(),r.strokeStyle="black",r.fillStyle="black",r.moveTo(t,e-h),r.lineTo(t,e+h),r.translate(t,e),r.rotate(-Math.PI/2),r.textAlign="center",r.font="8px Arial",r.fillText(s,0,-5),r.stroke(),r.closePath(),r.restore()},c=function(){for(r.clearRect(-100,-100,1e3,1e3),r.strokeStyle="black",r.fillStyle="black",r.beginPath(),u=0;u<l.length;u++){var a=l[u];r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2)}r.stroke(),r.closePath(),r.beginPath(),r.strokeStyle="gray",r.fillStyle="gray",r.arc(o.x,o.y,8,0,2*Math.PI),r.stroke(),r.closePath();var c=o.x+20*Math.cos(Math.PI/180*o.theta),d=o.y+20*Math.sin(Math.PI/180*o.theta);r.strokeStyle="green",r.fillStyle="green",r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(c,d),r.stroke(),r.closePath();for(var P=0,f=[],k=[],M=(p=360/o.lidarMinResolution)/2,u=o.theta;u<o.theta+360;u+=o.lidarMinResolution,P++){for(var v=o.x+Math.cos(Math.PI/180*u)*o.lidarLength,g=o.y+Math.sin(Math.PI/180*u)*o.lidarLength,x=void 0,S=0;S<l.length;S++){a=l[S];var b=e(o.x,o.y,v,g,a.x1,a.y1,a.x2,a.y2);if(b){var I=i.process(P,t(o.x,o.y,b.x,b.y,n(o.lidarNoise)));x?x.distance>I&&(x={distance:I,intersection:b}):x={distance:I,intersection:b}}}if(x){f[P]=x.distance,k[P]=u;var m=Math.PI/180*u,T=o.x+Math.cos(m)*x.distance,w=o.y+Math.sin(m)*x.distance;r.beginPath(),r.strokeStyle="CadetBlue",r.fillStyle="CadetBlue",r.arc(T,w,2,0,2*Math.PI),r.stroke(),r.closePath(),r.beginPath(),0===P?(r.strokeStyle="green",r.fillStyle="green"):(r.strokeStyle="CadetBlue",r.fillStyle="CadetBlue");var A=200+(P+M)%p,R=(N=50)-x.distance;r.moveTo(A,N),r.lineTo(A,R),r.stroke(),r.closePath()}else r.strokeStyle="rgba(128,128,128,0.05)",r.fillStyle="rgba(128,128,128,0.05)",r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(v,g),r.stroke(),r.closePath()}r.save(),r.beginPath(),r.strokeStyle="black",r.fillStyle="black",r.moveTo(200,50),r.lineTo(200,-70),r.translate(200,50),r.rotate(-Math.PI/2),r.textAlign="center",r.font="8px Arial",r.fillText("Lidar distance",60,-5),r.stroke(),r.closePath(),r.restore();var L=h(f,P,1),V=h(L,P,1),p=360/o.lidarMinResolution;y(200,90,"DarkSlateGrey",L,p,M=p/2,3,"1st derivative",20),y(200,160,"DarkSlateGrey",V,p,M,15,"2nd derivative",20);for(u=0;u<P;u++){var B=s(u,L,p),C=s(u-1,L,p),q=s(u,V,p),D=!1;B&&C&&q&&(C>=0&&B<0?D=!0:C<0&&B>.025&&(D=!0));I=f[u];if(D&&I){var E=k[u],F=(m=Math.PI/180*E,o.x+Math.cos(m)*I),G=o.y+Math.sin(m)*I;r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(F,G,2,0,2*Math.PI),r.stroke(),r.closePath(),r.strokeStyle="lightgray",r.fillStyle="lightgray",r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(F,G),r.stroke(),r.closePath();A=200+(u+(M=(p=360/o.lidarMinResolution)/2))%p,R=(N=90)-L[u];r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(A,R,2,0,2*Math.PI),r.stroke(),r.closePath();var N;A=200+(u+M)%p,R=(N=50)-f[u];r.beginPath(),r.strokeStyle="red",r.fillStyle="red",r.arc(A,R,2,0,2*Math.PI),r.stroke(),r.closePath()}}},d=function t(){c(),window.requestAnimationFrame(t)};window.requestAnimationFrame(d),window.addEventListener("keydown",function(t){"ArrowUp"==t.key&&(o.x+=3*Math.cos(Math.PI/180*o.theta),o.y+=3*Math.sin(Math.PI/180*o.theta)),"ArrowDown"==t.key&&(o.x+=-3*Math.cos(Math.PI/180*o.theta),o.y+=-3*Math.sin(Math.PI/180*o.theta)),"ArrowLeft"==t.key&&(o.theta-=2),"ArrowRight"==t.key&&(o.theta+=2)});
},{}]},{},["d6sW"], null)
//# sourceMappingURL=main.8959f12e.js.map